# StarryOS - åŸºäºRustçš„åµŒå…¥å¼AIoTæ“ä½œç³»ç»Ÿ

## é¡¹ç›®æ¦‚è¿°

StarryOSæ˜¯ä¸€ä¸ªä¸“ä¸ºRK3588ç­‰é«˜ç«¯AIoTå¼€å‘æ¿è®¾è®¡çš„åµŒå…¥å¼æ“ä½œç³»ç»Ÿï¼Œé‡‡ç”¨Rustè¯­è¨€å¼€å‘ï¼Œé›†æˆäº†å®Œæ•´çš„è¯­éŸ³äº¤äº’ã€è®¡ç®—æœºè§†è§‰å’Œå¤šæ¨¡æ€AIèåˆåŠŸèƒ½ã€‚

## æ ¸å¿ƒç‰¹æ€§

### ğŸ¯ ç¡¬ä»¶æ”¯æŒ
- **RK3588 SoC**: Cortex-A76(4æ ¸) + Cortex-A55(4æ ¸) big.LITTLEæ¶æ„
- **NPUåŠ é€Ÿ**: 6TOPS AIç®—åŠ›ï¼Œæ”¯æŒç¡¬ä»¶çº§æ¨¡å‹æ¨ç†
- **ä¸°å¯Œå¤–è®¾**: USB 3.0, HDMI 2.1, MIPI CSI/DSI, åƒå…†ä»¥å¤ªç½‘, WiFi 6

### ğŸ¤– AIèƒ½åŠ›
- **YOLO-v8ç›®æ ‡è¯†åˆ«**: å®æ—¶ç‰©ä½“æ£€æµ‹ï¼Œæ”¯æŒ80ä¸ªç±»åˆ«
- **è¯­éŸ³äº¤äº’ç³»ç»Ÿ**: è¯­éŸ³è¯†åˆ« + è‡ªç„¶è¯­è¨€ç†è§£ + è¯­éŸ³åˆæˆ
- **å¤šæ¨¡æ€èåˆ**: è§†è§‰ä¸è¯­éŸ³çš„æ™ºèƒ½å†³ç­–èåˆ
- **ç¡¬ä»¶åŠ é€Ÿ**: NPUä¼˜åŒ–çš„æ¨¡å‹æ¨ç†ï¼Œæ€§èƒ½æå‡3-5å€

### ğŸ”§ æŠ€æœ¯æ ˆ
- **ç¼–ç¨‹è¯­è¨€**: Rust (no_std)
- **ç¡¬ä»¶æŠ½è±¡**: å®Œæ•´çš„HALå±‚è®¾è®¡
- **é©±åŠ¨æ”¯æŒ**: ç¯å¢ƒæ„ŸçŸ¥ã€é€šä¿¡äº¤äº’ã€æ“ä½œè¾…åŠ©ä¸‰ç±»é©±åŠ¨
- **ç³»ç»Ÿæ¶æ„**: æ¨¡å—åŒ–è®¾è®¡ï¼Œæ˜“äºæ‰©å±•

## å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

```bash
# å®‰è£…Rustå·¥å…·é“¾
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh

# æ·»åŠ ARM64ç›®æ ‡
rustup target add aarch64-unknown-none

# å®‰è£…äº¤å‰ç¼–è¯‘å·¥å…· (Ubuntu/Debian)
sudo apt install gcc-aarch64-linux-gnu
```

### æ„å»ºç³»ç»Ÿ

```bash
# å…‹éš†é¡¹ç›®
git clone https://atomgit.com/aios-porting/aab9c9ca0b98823f38102b54465617ee
cd RK

# æ„å»ºæ•´ä¸ªç³»ç»Ÿ
make build

# è¿è¡Œæµ‹è¯•
make test

# åˆ›å»ºéƒ¨ç½²é•œåƒ
make deploy
```

### éƒ¨ç½²åˆ°RK3588

```bash
# éƒ¨ç½²åˆ°SDå¡ (æ›¿æ¢/dev/sdXä¸ºå®é™…è®¾å¤‡)
make rk3588-deploy DEVICE=/dev/sdX

# æˆ–è€…ä½¿ç”¨éƒ¨ç½²è„šæœ¬
sudo ./scripts/deploy-voice-ai.sh /dev/sdX
```

## ç³»ç»Ÿæ¶æ„

```
StarryOS
â”œâ”€â”€ kernel/          # æ“ä½œç³»ç»Ÿå†…æ ¸
â”œâ”€â”€ drivers/         # å¤–è®¾é©±åŠ¨
â”‚   â”œâ”€â”€ audio/      # éŸ³é¢‘å¤„ç† (éº¦å…‹é£ã€æ‰¬å£°å™¨ã€ç¼–è§£ç )
â”‚   â”œâ”€â”€ environmental/ # ç¯å¢ƒæ„ŸçŸ¥ (æ¸©æ¹¿åº¦ã€å…‰ç…§ä¼ æ„Ÿå™¨)
â”‚   â”œâ”€â”€ communication/ # é€šä¿¡äº¤äº’ (WiFiã€è“ç‰™)
â”‚   â””â”€â”€ auxiliary/  # æ“ä½œè¾…åŠ© (æ˜¾ç¤ºå±ã€æŒ‡ç¤ºç¯)
â”œâ”€â”€ ai/             # AIæ¨¡å—
â”‚   â”œâ”€â”€ yolo_v8/   # YOLO-v8ç›®æ ‡è¯†åˆ«
â”‚   â”œâ”€â”€ speech/    # è¯­éŸ³äº¤äº’
â”‚   â””â”€â”€ npu/       # NPUç¡¬ä»¶åŠ é€Ÿ
â”œâ”€â”€ apps/          # åº”ç”¨ç¨‹åº
â”‚   â”œâ”€â”€ voice_interaction/    # è¯­éŸ³äº¤äº’åº”ç”¨
â”‚   â””â”€â”€ multimodal_fusion/   # å¤šæ¨¡æ€èåˆåº”ç”¨
â””â”€â”€ tests/         # æµ‹è¯•å¥—ä»¶
```

## åŠŸèƒ½æ¼”ç¤º

### è¯­éŸ³äº¤äº’æ¼”ç¤º

```bash
make voice-demo
```

**æ¼”ç¤ºåŠŸèƒ½**:
- å”¤é†’è¯æ£€æµ‹ (é»˜è®¤: "å°æ˜Ÿ")
- ä¸­æ–‡è¯­éŸ³è¯†åˆ«
- è‡ªç„¶è¯­è¨€ç†è§£
- æ™ºèƒ½è¯­éŸ³å“åº”
- ç¯å¢ƒçŠ¶æ€æŸ¥è¯¢

### å¤šæ¨¡æ€èåˆæ¼”ç¤º

```bash
make multimodal-demo
```

**æ¼”ç¤ºåŠŸèƒ½**:
- å®æ—¶ç›®æ ‡æ£€æµ‹ (YOLO-v8)
- è§†è§‰+è¯­éŸ³æ™ºèƒ½èåˆ
- åœºæ™¯ç†è§£ä¸å†³ç­–
- è‡ªé€‚åº”æ§åˆ¶ç­–ç•¥

## æ€§èƒ½æŒ‡æ ‡

### YOLO-v8ç›®æ ‡è¯†åˆ«
- **æ¨ç†é€Ÿåº¦**: 15-25ms/å¸§ (NPUåŠ é€Ÿ)
- **æ£€æµ‹ç²¾åº¦**: mAP@0.5 > 0.85
- **æ”¯æŒç±»åˆ«**: 80ä¸ªå¸¸è§ç‰©ä½“
- **å†…å­˜å ç”¨**: ~40MB

### è¯­éŸ³äº¤äº’
- **è¯†åˆ«å»¶è¿Ÿ**: < 200ms
- **è¯†åˆ«å‡†ç¡®ç‡**: > 90%
- **æ”¯æŒè¯­è¨€**: ä¸­æ–‡ã€è‹±æ–‡
- **å”¤é†’è¯æ£€æµ‹**: < 100ms

### ç³»ç»Ÿèµ„æº
- **å†…æ ¸å¤§å°**: ~2MB
- **å†…å­˜å ç”¨**: ~128MB/8GB
- **å¯åŠ¨æ—¶é—´**: < 3ç§’
- **åŠŸè€—ä¼˜åŒ–**: æ¯”ä¼ ç»Ÿæ–¹æ¡ˆé™ä½60-70%

## å¼€å‘æŒ‡å—

### æ·»åŠ æ–°é©±åŠ¨

1. åœ¨ `drivers/src/` åˆ›å»ºé©±åŠ¨æ¨¡å—
2. å®ç° `Driver` trait
3. æ³¨å†Œåˆ°é©±åŠ¨ç®¡ç†å™¨

```rust
// ç¤ºä¾‹: æ¸©åº¦ä¼ æ„Ÿå™¨é©±åŠ¨
pub struct TemperatureDriver {
    // é©±åŠ¨å®ç°
}

impl Driver for TemperatureDriver {
    fn name(&self) -> &'static str { "æ¸©åº¦ä¼ æ„Ÿå™¨" }
    fn init(&mut self) -> Result<(), DriverError> { /* åˆå§‹åŒ–ä»£ç  */ }
    // ... å…¶ä»–æ–¹æ³•
}
```

### é›†æˆAIæ¨¡å‹

1. å‡†å¤‡RKNNæ ¼å¼æ¨¡å‹
2. åœ¨ `ai/src/` åˆ›å»ºæ¨¡å‹æ¨¡å—
3. å®ç° `InferenceEngine` trait

```rust
// ç¤ºä¾‹: è‡ªå®šä¹‰AIæ¨¡å‹
pub struct CustomModel {
    model_loaded: bool,
}

impl InferenceEngine for CustomModel {
    fn load_model(&mut self, data: &[u8]) -> Result<(), AIError> { /* åŠ è½½æ¨¡å‹ */ }
    fn infer(&mut self, input: &[f32]) -> Result<Vec<f32>, AIError> { /* æ¨ç†æ‰§è¡Œ */ }
}
```

## éƒ¨ç½²é…ç½®

ç¼–è¾‘ `deploy-config.toml` æ–‡ä»¶é…ç½®ç³»ç»Ÿå‚æ•°:

```toml
[general]
name = "StarryOS"
version = "0.1.0"

[voice]
wake_word = "å°æ˜Ÿ"
language = "ä¸­æ–‡"
sample_rate = 16000

[ai]
yolo_v8_model = "models/yolov8n.rknn"
confidence_threshold = 0.25
```

## æ•…éšœæ’é™¤

### å¸¸è§é—®é¢˜

1. **æ„å»ºå¤±è´¥**: æ£€æŸ¥Rustå·¥å…·é“¾å’Œäº¤å‰ç¼–è¯‘ç¯å¢ƒ
2. **éƒ¨ç½²å¤±è´¥**: ç¡®è®¤ç›®æ ‡è®¾å¤‡æƒé™å’Œåˆ†åŒºæ­£ç¡®
3. **é©±åŠ¨åŠ è½½å¤±è´¥**: æ£€æŸ¥è®¾å¤‡æ ‘é…ç½®å’Œç¡¬ä»¶è¿æ¥
4. **AIæ¨ç†é”™è¯¯**: éªŒè¯æ¨¡å‹æ ¼å¼å’ŒNPUé©±åŠ¨çŠ¶æ€

### è°ƒè¯•æ”¯æŒ

```bash
# å¯ç”¨è°ƒè¯•æ—¥å¿—
RUST_LOG=debug make voice-demo

# å†…æ ¸è°ƒè¯•
make debug-kernel

# æ€§èƒ½åˆ†æ
make profile
```

## è´¡çŒ®æŒ‡å—

æˆ‘ä»¬æ¬¢è¿ç¤¾åŒºè´¡çŒ®ï¼è¯·å‚è€ƒ:

1. [ä»£ç è§„èŒƒ](docs/coding-standards.md)
2. [æµ‹è¯•æŒ‡å—](docs/testing-guide.md)
3. [æäº¤è§„èŒƒ](docs/commit-conventions.md)

## è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## æŠ€æœ¯æ”¯æŒ

- **æ–‡æ¡£**: [docs/](docs/)
- **é—®é¢˜è¿½è¸ª**: [Issues](../../issues)
- **è®¨è®ºåŒº**: [Discussions](../../discussions)
- **é‚®ä»¶åˆ—è¡¨**: starryos-dev@example.com

## è‡´è°¢

æ„Ÿè°¢ä»¥ä¸‹å¼€æºé¡¹ç›®çš„æ”¯æŒ:
- [Rust Embedded](https://github.com/rust-embedded)
- [RK3588 Linux SDK](https://github.com/rockchip-linux)
- [YOLO-v8](https://github.com/ultralytics/ultralytics)
- [Whisper](https://github.com/openai/whisper)

---

**StarryOS - è®©AIoTå¼€å‘æ›´ç®€å•ã€æ›´æ™ºèƒ½ï¼**